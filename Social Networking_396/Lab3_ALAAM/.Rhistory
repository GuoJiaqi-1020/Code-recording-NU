install.packages("mvtnorm")
library(mvtnorm)
install.packages("xtable")
library(xtable)
## download the s50 dataset from the website
## For a description of the full dataset, see https://www.stats.ox.ac.uk/~snijders/siena/s50_data.htm
temp <- tempfile()
download.file("https://www.stats.ox.ac.uk/~snijders/siena/s50_data.zip",temp)
adj <- read.table(unz(temp, "s50-network1.dat"))
sport <- read.table(unz(temp, "s50-sport.dat"))
smoke <- read.table(unz(temp, "s50-smoke.dat"))
alcohol <- read.table(unz(temp, "s50-alcohol.dat"))
unlink(temp)
## Format the network and set at the 2nd wave as our outcome variable
n <- nrow(adj)
adj <- as.matrix(adj) # convert from data.frame to matrix
smoke <- smoke[,2] # use wave 2
smoke[smoke<2] <- 0 # set non-smoker to 0
smoke[smoke>0] <- 1 # set occasional and regular to 1
## Download the script `MultivarALAAMalt.R` and read in the routines
# Make sure you have set the working directory to where you store the file
# If you have this script stored in the same folder
# Session ==> Set Working Directory ==> To Source File Location
source('MultivarALAAMalt.R')
## Below can be pre-calculated and used as monadic covariates
out.degree <-matrix( rowSums(adj), n, 1) # number of ties sent
in.degree <- matrix( colSums(adj) , n, 1 ) # number of ties received
rec.ties <-  matrix( rowSums(adj * t(adj) ), n , 1) # number of ties that are mutual
in.two.star <- matrix( choose(in.degree,2),n,1) #  in-stars refecting dispersion in popularity
out.two.star <- matrix( choose(out.degree,2),n,1) #  out-stars refecting dispersion in activity
mix.two.star <- in.degree*out.degree - rec.ties # correlation between indegree and outdegree
in.three.star <- matrix( choose(in.degree,3),n,1) # furhter measure of in-degree heterogeneity
out.three.star <- matrix( choose(out.degree,3),n,1) # furhter measure of out-degree heterogeneity
triangles <- rowSums( adj* (adj %*% t(adj) )  ) # embedded in transitive triads
## Format covariates by putting them all into a matrix (the column names are only required for formatting the output)
covs <- cbind(sport[,1],
alcohol[,1],
out.degree,
in.degree,
rec.ties,
in.two.star,
out.two.star,
mix.two.star,
in.three.star,
out.three.star,
triangles)
colnames(covs) <- c("Sport",
"Alcohol",
"indegree",
"outdegree",
"reciprochation" ,
"instar",
"outstar",
"twopath",
"in3star",
"out3star",
"transitive")
head(covs)
res.0 <- BayesALAAM(y = smoke,           # dependent variable
ADJ = adj,           # network
covariates = covs,   # covariates
directed = TRUE,     # directed / undirecred network
Iterations = 1000,   # number of iterations
saveFreq = 100,      # print and save frequency
contagion = 'none')  # type of contagion
plot(ts(res.0$Theta[,1:6]))
plot(ts(res.0$Theta[,7:13]))
res.0 <- BayesALAAM(y = smoke,           # dependent variable
ADJ = adj,           # network
covariates = covs,   # covariates
directed = TRUE,     # directed / undirecred network
Iterations = 1000,   # number of iterations
saveFreq = 100,      # print and save frequency
contagion = 'none')  # type of contagion
